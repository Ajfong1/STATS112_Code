---
title: "STATS 112 Project EDA"
author: "Phoebe Chen"
output:
  pdf_document: default
  html_document: default
date: "2025-11-12"
---

# Load Data

```{r}
# Load data
mba <- read.csv("MBA.csv")

# View structure and summary
str(mba)
summary(mba)

# Check missing values
colSums(is.na(mba))
```

# Clean Data

```{r}
# Replace null admission with "Deny"
mba$admission <- ifelse(mba$admission == "", "Deny", mba$admission)

#Replace null race with "INTL"
mba$race <- ifelse(mba$race == "", "INTL", mba$race)
mba$race <- ifelse(mba$race == "Other", "INTL", mba$race)

# Convert key columns to factors
mba$gender <- as.factor(mba$gender)
mba$major <- as.factor(mba$major)
mba$admission <- factor(mba$admission, levels = c("Deny", "Waitlist", "Admit"))
```

# Counts of admission results, Proportions of admission results

```{r}
# Frequency and proportion by gender
table_gender <- table(mba$gender, mba$admission)
prop_gender <- prop.table(table_gender, margin = 1) * 100

table_gender
# round(prop_gender, 1)
prop_gender
```
The proportion of female admits is equal to proportion of male admits during this year. Hence, different acceptance rates per gender.
Females are admitted at a higher rate than males.
Does synthetic data mean more equivalent measures of central tendency?

# Barplot of Admission Outcomes by Gender

```{r}
# Barplot: Admission outcomes by gender
barplot(t(prop_gender),
        beside = TRUE,
        col = c("lightcoral", "khaki", "lightgreen"),
        ylim = c(0, 100),
        legend.text = TRUE,
        args.legend = list(x = "topright"),
        main = "Admission Outcomes by Gender",
        ylab = "Percentage",
        xlab = "Gender")
```
Proportions of admission outcomes appear similar, but Females have higher acceptance and waitlist rates.

# Admission Rates (Admit Only) By Gender and by Gender and Race

```{r}
# Compute admission rates (Admit only)
admit_summary <- with(mba, tapply(admission == "Admit", gender, mean)) * 100
admit_summary

# Create a summary table
table_gender_major <- with(mba, table(gender, major, admission))
prop_gender_major <- prop.table(table_gender_major, margin = c(1,2)) * 100

prop_gender_major[, , "Admit"]
```
Females have a higher admission rate in 2025 than males.
There is little to no difference in admission rates across majors.

```{r}
# Plot admission rate by gender and major
admit_rate <- as.data.frame(prop_gender_major[, , "Admit"])
names(admit_rate) <- c("Gender", "Major", "AdmitRate")

# Basic grouped barplot
barplot(height = tapply(admit_rate$AdmitRate,
                        list(admit_rate$Major, admit_rate$Gender),
                        c),
        beside = TRUE,
        col = c("skyblue", "salmon", "palegreen"),
        main = "Admission Rate by Gender and Major",
        ylab = "Admit Rate (%)",
        ylim = c(0, 100))
legend("topright", legend = levels(mba$gender),
       fill = c("skyblue", "salmon"))

```
Females are admitted at a higher rate than males. There is no significant difference across majors.

# Average GPA, GMAT, Work Experience by Gender

```{r}
# Summary statistics by gender
aggregate(cbind(gpa, gmat, work_exp) ~ gender, data = mba, mean)
```

# Boxplots for GPA, GMAT, and Work Experience by Gender

```{r}
#Boxplots
par(mfrow = c(1, 3))
boxplot(gpa ~ gender, data = mba, col = "lightblue",
        main = "GPA by Gender", ylab = "GPA")
boxplot(gmat ~ gender, data = mba, col = "lightpink",
        main = "GMAT by Gender", ylab = "GMAT Score")
boxplot(work_exp ~ gender, data = mba, col = "lightgreen",
        main = "Work Experience by Gender", ylab = "Years")
par(mfrow = c(1, 1))
```
There is no variation in GPA, GMAT, and Work Experience between male and female applicants.

# Chi-square test for Gender vs Admission

```{r}
# Chi-square test for gender vs admission
tbl <- table(mba$gender, mba$admission)
chisq.test(tbl)
```
Gender and admission outcome are not independent. The distribution of Admit / Waitlist / Deny differs between men and women more than we would expect by chance.

If gender differences don’t appear: That might be a positive finding — showing equitable admissions. Or it could reflect that the applicant pool itself is already self-selected (e.g., fewer women apply in STEM, but those who do are just as competitive). So, you might ask: “Are there gender differences in who applies rather than who gets in?” That could shift your research focus from admissions outcomes to application patterns.

# Logistic Model with Interactions

```{r}
# Logistic model for Admit (1) vs Deny (0)
mba$admit_bin <- ifelse(mba$admission == "Admit", 1, 0)
model1 <- glm(admit_bin ~ gender * gmat + gender * major + gender * work_exp, 
    data = mba, family = binomial)
summary(model1)
```
Significant: Gender, GMAT, Gender and GMAT interaction

# Logistic Model Without Interactions

```{r}
model2 <- glm(admit_bin ~ gpa + gmat + work_exp + major + gender + race,
    data = mba, family = binomial)
summary(model2)
```
Largest coefficients: GPA
Significant: GPA, GMAT, gender Male, race Black, race 

Significant Predictor	Interpretation
GPA	Higher GPA → higher chance of admission
GMAT	Higher GMAT → higher chance of admission
Gender (Male)	→ Men have a significantly different probability of admission than women (direction depends on coefficient sign) → Women are more likely to be admitted
Race (Black) → Applicants coded as Black differ significantly in admission probability → Black applicants are less likely to be admitted
Race (Hispanic)	→ Applicants coded as Hispanic differ significantly → Hispanic applicants are less likely to be admited

Sometimes:
* Raw (chi-square) suggests a gender difference
* Logistic model shows the gender effect disappears
This means: The gender gap was actually explained by differences in GPA/GMAT/major, not gender itself.
If gender stays significant in the logistic model, then: Gender has an independent effect even after adjusting for qualifications.

# Odds Ratios

```{r}
exp(coef(model2))
```
Men are ?

# Check interactions

```{r}
model3 <- glm(admit_bin ~ major + gender * gmat + gender * race + gender * gpa + work_exp,
    data = mba, family = binomial)
summary(model3)
```
For GMAT:
→ The slope of admission probability across GMAT scores differs by gender. GMAT scores increase the probability of admission at different rates for men vs. women. The interaction coefficient is positive: The effect of GMAT on admission is stronger for men. (High-GMAT women see a larger increase in admission probability than high-GMAT men)

For GPA:
→ The slope of admission probability across GPA levels differs by gender. The admissions committee may value high GPAs more for males. Male admission probability increases more steeply as GPA rises.

This means you should not interpret “gender,” “GPA,” or “GMAT” separately —
because their effects depend on each other.

Gender disparities in admission are conditional, not general. Academic qualifications have different “returns” depending on gender. The effect of GPA/GMAT depends on gender.

# Check ?

```{r}
new <- expand.grid(
  gender = c("Male", "Female"),
  gmat = seq(min(mba$gmat), max(mba$gmat), length=50),
  gpa = mean(mba$gpa),
  race = "White",
  work_exp = mean(mba$work_exp),
  major = "Business"
)

new$pred <- predict(model3, newdata=new, type="response")
```


# Counts of Admission Outcomes by Race and Total Race Counts

```{r}
table(mba$race, mba$admission)

table(mba$race)
```
Counts of admits per race are different. Many applicants are international students.

# Acceptance Rates by Race

```{r}
prop_race <- prop.table(table(mba$race, mba$admission), margin = 1)
round(prop_race, 3)
```
Acceptance rates by race are very similar -> Black and Hispanic have lower acceptance rate

# Conclusions:

Conclusion A — Gender has an independent effect
If genderMale is significant in the logistic model: Even after controlling for GPA, GMAT, work experience, major, and race, gender still significantly predicts admission. This indicates that men and women with similar profiles do not have equal probabilities of admission. You can interpret the size of this effect with odds ratios.

Conclusion B — Race matters
If Black and Hispanic indicators are significant: There are systematic differences in admission outcomes associated with race, even when academic and work qualifications are held constant.


Conclusion C — Academic metrics best predict admission
If GPA and GMAT are both strong predictors: Admissions decisions are driven primarily by academic profile (GMAT and GPA).


Conclusion D — Major is not significant
If major is not significant: Undergraduate major does not independently affect admission odds when academic metrics are controlled.